---
title: "FinalProject"
author: "Eeman, Linda, Sofia"
date: "2025-11-06"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

gender, air pollution, genetic risk, smoking, diet, alcohol

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(tidyverse)

dat <- read_csv("cancer patient data sets 2.csv")

library(MASS)

dat <- read_csv("cancer patient data sets 2.csv")

names(dat) <- make.names(names(dat))

names(dat)

dat$Level <- factor(dat$Level,
                     levels = c("Low","Medium","High"),
                     ordered = TRUE)

dat <- dat |>
  mutate(High = if_else(Level == "High", 1, 0))



m1 <- glm(High ~ Gender + Genetic.Risk + Age + Smoking + Air.Pollution + Obesity + Chest.Pain + Coughing.of.Blood + Shortness.of.Breath, data = dat, family = "binomial")

summary(m1)

exp(7.6069)
exp(4.1667)
exp(6.3718)
exp(-0.7692)
exp( 10.4882)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
library(tidyverse)
data <- read_csv("cancer patient data sets 2.csv")

m2 <- glm(High ~ Gender + Genetic.Risk + Age + Smoking + Air.Pollution + Obesity, data = dat, family = "binomial")

summary(m2)
```


gender, air pollution, genetic risk, smoking, diet, alcohol

```{r}
library(ggplot2)
ggplot(dat, aes(x = Level, y = `Air Pollution`)) +
  geom_bar(stat = "identity")
ggplot(dat, aes(x = Level, y = `Genetic Risk`)) +
  geom_bar(stat = "identity")
ggplot(dat, aes(x = Level, y = `Smoking`)) +
  geom_bar(stat = "identity")

table(dat$"Genetic Risk", dat$Level)
chisq.test(table(dat$"Genetic Risk", dat$Level)) 

```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r cars}

library(tidyverse)

dat_long <- dat|>
  pivot_longer(
    cols = c(`Air Pollution`, `Genetic Risk`, Smoking, `Alcohol use`),
    names_to = "Variable",
    values_to = "Value")


ggplot(dat_long, aes(x = Level, y = Value, fill = Level)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_bw()


library(tidyverse)

dat <- read_csv("cancer patient data sets 2.csv")

library(tidyverse)
library(MASS)

data <- read_csv("cancer patient data sets 2.csv")

names(data) <- make.names(names(data))

names(data)

data$Level <- factor(data$Level,
                     levels = c("Low","Medium","High"),
                     ordered = TRUE)

m1 <- lm(Level ~ Age + Gender + Air.Pollution + Alcohol.use + Dust.Allergy + OccuPational.Hazards + Genetic.Risk + chronic.Lung.Disease + Balanced.Diet + Obesity + Smoking + Passive.Smoker + Chest.Pain + Coughing.of.Blood + Fatigue + Weight.Loss + Shortness.of.Breath + Wheezing + Swallowing.Difficulty + Clubbing.of.Finger.Nails + Frequent.Cold + Dry.Cough + Snoring, data = data)


print(m1)


```

